<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V2Ray Configuration Generator</title>
</head>
<body>
    <h1>V2Ray Configuration Generator</h1>
    <form id="configForm">

        <label for="yourDomain">Your Domain:</label>
        <input type="text" id="yourDomain" name="yourDomain" placeholder="e.g., example.com" required><br>
        
        <label for="port">Port:</label>
        <select id="port" name="port">
            <option value="443">443</option>
            <option value="8443">8443</option>
            <option value="2053">2053</option>
            <option value="2096">2096</option>
            <option value="2087">2087</option>
            <option value="2083">2083</option>
        </select><br>

        <label for="userUUID">User UUID:</label>
        <input type="text" id="userUUID" name="userUUID" placeholder="Enter User UUID" required><br>

        <label for="path">Path (Optional):</label>
        <input type="text" id="path" name="path" placeholder="Enter Path"><br>

        <label for="tls">Enable TLS:</label>
        <input type="checkbox" id="tls" name="tls"><br>

        <button type="button" onclick="generateConfig()">Generate Configuration</button>
    </form>

    <pre id="configOutput"></pre>

    <script>
        function generateConfig() {
            const yourDomain = document.getElementById('yourDomain').value;
            const port = document.getElementById('port').value;
            const userUUID = document.getElementById('userUUID').value;
            const path = document.getElementById('path').value;
            const tls = document.getElementById('tls').checked;

            // Constants
            const portsList = [443, 8443, 2053, 2096, 2087, 2083];

            // Randomized constants
            const randomPort = portsList[Math.floor(Math.random() * portsList.length)];
            const randomizedDomain = yourDomain.split('').map(char => Math.random() > 0.5 ? char.toUpperCase() : char.toLowerCase()).join('');
            const randomPath = path || '/' + generateRandomString(59);

            // Configuration object
            const config = {
                "log": {
                    "access": "",
                    "error": "",
                    "loglevel": "warning"
                },
                "inbounds": [
                    {
                        "tag": "socks",
                        "port": 10808,
                        "listen": "127.0.0.1",
                        "protocol": "socks",
                        "sniffing": {
                            "enabled": true,
                            "destOverride": [
                                "http",
                                "tls"
                            ],
                            "routeOnly": false
                        },
                        "settings": {
                            "auth": "noauth",
                            "udp": true,
                            "allowTransparent": false
                        }
                    },
                    {
                        "tag": "http",
                        "port": 10809,
                        "listen": "127.0.0.1",
                        "protocol": "http",
                        "sniffing": {
                            "enabled": true,
                            "destOverride": [
                                "http",
                                "tls"
                            ],
                            "routeOnly": false
                        },
                        "settings": {
                            "auth": "noauth",
                            "udp": true,
                            "allowTransparent": false
                        }
                    }
                ],
                "outbounds": [
                    {
                        "tag": "proxy",
                        "protocol": "vless",
                        "settings": {
                            "vnext": [
                                {
                                    "address": randomizedDomain,
                                    "port": port,
                                    "users": [
                                        {
                                            "id": userUUID,
                                            "alterId": 0,
                                            "email": "t@t.tt",
                                            "security": "auto",
                                            "encryption": "none",
                                            "flow": ""
                                        }
                                    ]
                                }
                            ]
                        },
                        "streamSettings": {
                            "network": "ws",
                            "security": "tls",
                            "tlsSettings": {
                                "allowInsecure": false,
                                "serverName": randomizedDomain,
                                "alpn": [
                                    "h2",
                                    "http/1.1"
                                ],
                                "fingerprint": "chrome",
                                "show": false
                            },
                            "wsSettings": {
                                "path": randomPath,
                                "headers": {
                                    "Host": randomizedDomain
                                }
                            },
                            "sockopt": {
                                "dialerProxy": "fragment",
                                "tcpKeepAliveIdle": 100,
                                "mark": 255,
                                "tcpNoDelay": true
                            }
                        },
                        "mux": {
                            "enabled": false,
                            "concurrency": -1
                        }
                    },
                    {
                        "tag": "fragment",
                        "protocol": "freedom",
                        "settings": {
                            "domainStrategy": "AsIs",
                            "fragment": {
                                "packets": "tlshello",
                                "length": "10-20",
                                "interval": "10-20"
                            }
                        },
                        "streamSettings": {
                            "sockopt": {
                                "tcpNoDelay": true,
                                "tcpKeepAliveIdle": 100
                            }
                        }
                    },
                    {
                        "tag": "direct",
                        "protocol": "freedom",
                        "settings": {}
                    },
                    {
                        "tag": "block",
                        "protocol": "blackhole",
                        "settings": {
                            "response": {
                                "type": "http"
                            }
                        }
                    }
                ],
                "routing": {
                    "domainStrategy": "AsIs",
                    "rules": [
                        {
                            "type": "field",
                            "inboundTag": [
                                "api"
                            ],
                            "outboundTag": "api",
                            "enabled": true
                        },
                        {
                            "id": "5627785659655799759",
                            "type": "field",
                            "port": "0-65535",
                            "outboundTag": "proxy",
                            "enabled": true
                        }
                    ]
                }
            };

            // Respond with the JSON configuration
            document.getElementById('configOutput').innerText = `addEventListener('fetch', event => {
    event.respondWith(handleRequest(event.request))
})

// Utility functions
const selectRandomItem = (items) => items[Math.floor(Math.random() * items.length)];

const generateRandomString = (length, characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789') => {
    let result = '';
    for (let i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() * characters.length));
    }
    return result;
};

const randomizeCase = (str) => str.split('').map(char => Math.random() > 0.5 ? char.toUpperCase() : char.toLowerCase()).join('');

// Main handler function
async function handleRequest(request) {
    // Constants
    const portsList = [443, 8443, 2053, 2096, 2087, 2083];
    const domain = '${randomizedDomain}';
    const userUUID = '${userUUID}';

    // Randomized constants
    const randomPort = selectRandomItem(portsList);
    const randomizedDomain = '${randomizedDomain}';
    const randomPath = '${randomPath}';

    // Configuration object
    const config = ${JSON.stringify(config, null, 4)};

    // Respond with the JSON configuration
    return new Response(JSON.stringify(config, null, 2), {
        headers: { 'content-type': 'application/json' }
    });
}`;
        }

        // Utility functions
        function selectRandomItem(items) {
            return items[Math.floor(Math.random() * items.length)];
        }

        function generateRandomString(length, characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789') {
            let result = '';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }
    </script>
</body>
</html>
